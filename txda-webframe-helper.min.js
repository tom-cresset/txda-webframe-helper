var txdaWebframeHelper=(()=>{var p=Object.defineProperty;var y=e=>p(e,"__esModule",{value:!0});var C=(e,t)=>{y(e);for(var s in t)p(e,s,{get:t[s],enumerable:!0})};var X={};C(X,{initialize:()=>R});var d,T=new Uint8Array(16);function g(){if(!d&&(d=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!d))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return d(T)}var c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function M(e){return typeof e=="string"&&c.test(e)}var v=M;var n=[];for(u=0;u<256;++u)n.push((u+256).toString(16).substr(1));var u;function w(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase();if(!v(s))throw TypeError("Stringified UUID is invalid");return s}var l=w;function A(e,t,s){e=e||{};var a=e.random||(e.rng||g)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t){s=s||0;for(var r=0;r<16;++r)t[s+r]=a[r];return t}return l(a)}var f=A;var D=(e,t)=>{t._message&&e.addEventListener("message",s=>{t._message?.(s)}),t.onConnected&&e.addEventListener("message",s=>{s.data?.messageType==="txdaConnectionAcknowledgement"&&t.onConnected?.(s.data?.metaData)}),t.onUpdateCurrentDesign&&e.addEventListener("message",s=>{if(s.data?.messageType==="txdaCurrentDesign"){let{metaData:a,data:r}=s.data;t.onUpdateCurrentDesign?.(r,a)}}),t.onUpdateCurrentDesignStructure&&e.addEventListener("message",s=>{if(s.data?.messageType==="txdaCurrentDesignStructure"){let{metaData:a,data:r}=s.data;t.onUpdateCurrentDesignStructure?.(r,a)}})};var R=(e,t={})=>new Promise((s,a)=>{let r=new URL(e).origin;if(r==="*"){a("Specific target origins must be specified to connect to TXDA installs");return}function m(i){if(i.data?.messageType==="txdaMessagePortTransfer"){if(i.origin!==r){a("Attempted TXDA connection event from unauthorized origin");return}if(i.source!==window.parent){a("Attempted TXDA connection event from unauthorized source");return}let o=i.ports[0];D(o,t),o.start(),o.postMessage({messageType:"txdaRequestCurrentDesign"});let x={id:f(),_port:o,requestCurrentDesign:()=>o.postMessage({messageType:"txdaRequestCurrentDesign"}),requestCurrentDesignStructure:()=>o.postMessage({messageType:"txdaRequestCurrentDesignStructure"}),disconnect:()=>{o.close(),t.onDisconnected?.()}};s(x),window.removeEventListener("message",m)}}window.addEventListener("message",m),window.parent.postMessage({messageType:"txdaConnectionRequest",windowName:window.name},r),setTimeout(()=>{a("Connection to TXDA failed (timed out)")},1e4)});return X;})();
//# sourceMappingURL=txda-webframe-helper.min.js.map
